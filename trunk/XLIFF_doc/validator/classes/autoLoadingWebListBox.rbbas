#tag ClassProtected Class autoLoadingWebListBoxInherits WebListBox	#tag Method, Flags = &h0		Function getContentsAsCSV() As String		  // create CSV string from the contents of the listbox and it's headers		  		  		  dim csv as string		  dim colCnt as integer		  dim colItr as integer		  dim rowCnt as integer		  dim rowItr as integer		  dim thisLine(-1) as string		  colCnt = me.ColumnCount - 1		  		  // headers		  redim thisLine(-1)		  for colItr = 0 to colCnt		    thisLine.append common.csvEscape(me.heading(colItr))		  next colItr		  csv = csv + join(thisLine,",") + endofline		  		  // body		  rowCnt = me.RowCount -1		  for rowItr = 0 to rowCnt		    redim thisLine(-1)		    for colItr = 0 to colCnt		      thisLine.append common.csvEscape(me.cell(rowItr,colItr))		    next colItr		    csv = csv + join(thisLine,",") + endofline		  next rowItr		  		  return csv		  		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub ReloadWithTabContents(s as String, firstLineIsHeader as boolean = false)		  // wipes contents of listbox, replaces with contents passed in string.		  // for each tab in string, puts into a different column.		  // for each line break, put into different row.		  		  // wipe it.		  me.DeleteAllRows		  		  // load in passed string data		  dim thisLine,thisCell as string		  dim asLines(-1) as string		  dim asCells(-1) as string		  asLines = split(s,EndOfLine)		  // guess at number of columns based on # of tabs in first line.		  dim colCount as integer		  asCells = split(asLines(0),chr(9))		  colCount = ubound(asCells) + 1		  me.ColumnCount = colCount		  		  if firstLineIsHeader then		    dim colItr as integer		    for colItr = 0 to colCount - 1		      me.heading(colItr) = asCells(colItr)		    next colItr		    // have populate cells loop start with 2nd row		    asLines.Remove(0)		  end if		  		  // populate cells		  dim rowItr as integer		  for each thisLine in asLines		    // add row		    me.InsertRow(rowItr,"")		    // get each cell contents		    dim cellitr as integer		    for each thisCell in split(thisLine,chr(9))		      me.cell(rowItr,cellitr) = thisCell		      cellItr = cellitr + 1		    next		    rowItr = rowItr + 1		  next		End Sub	#tag EndMethod	#tag ViewBehavior		#tag ViewProperty			Name="AlternateRowColor"			Visible=true			Group="Behavior"			InitialValue="&cEDF3FE"			Type="Color"			InheritedFrom="WebListBox"		#tag EndViewProperty		#tag ViewProperty			Name="ColumnCount"			Visible=true			Group="Behavior"			InitialValue="1"			Type="Integer"			InheritedFrom="WebListBox"		#tag EndViewProperty		#tag ViewProperty			Name="ColumnWidths"			Visible=true			Group="Behavior"			InitialValue="*"			Type="String"			EditorType="MultiLineEditor"			InheritedFrom="WebListBox"		#tag EndViewProperty		#tag ViewProperty			Name="Cursor"			Visible=true			Group="Behavior"			InitialValue="0"			Type="Integer"			EditorType="Enum"			InheritedFrom="WebControl"			#tag EnumValues				"0 - Auto"				"1 - Standard Pointer"				"2 - Finger Pointer"				"3 - IBeam"				"4 - Wait"				"5 - Help"				"6 - Arrow All Directions"				"7 - Arrow North"				"8 - Arrow South"				"9 - Arrow East"				"10 - Arrow West"				"11 - Arrow North East"				"12 - Arrow North West"				"13 - Arrow South East"				"14 - Arrow South West"				"15 - Splitter East West"				"16 - Splitter North South"				"17 - Progress"				"18 - No Drop"				"19 - Not Allowed"				"20 - Vertical IBeam"				"21 - Crosshair"			#tag EndEnumValues		#tag EndViewProperty		#tag ViewProperty			Name="Enabled"			Visible=true			Group="Behavior"			InitialValue="True"			Type="Boolean"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="HasHeading"			Visible=true			Group="Behavior"			InitialValue="True"			Type="Boolean"			InheritedFrom="WebListBox"		#tag EndViewProperty		#tag ViewProperty			Name="Height"			Visible=true			Group="Behavior"			InitialValue="200"			Type="Integer"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="HelpTag"			Visible=true			Group="Behavior"			Type="String"			EditorType="MultiLineEditor"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="HorizontalCenter"			Group="Behavior"			Type="Integer"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			Type="Integer"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="ListIndex"			Visible=true			Group="Behavior"			InitialValue="-1"			Type="Integer"			InheritedFrom="WebListBox"		#tag EndViewProperty		#tag ViewProperty			Name="LockBottom"			Visible=true			Group="Behavior"			InitialValue="False"			Type="Boolean"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="LockHorizontal"			Visible=true			Group="Behavior"			InitialValue="False"			Type="Boolean"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="LockLeft"			Visible=true			Group="Behavior"			InitialValue="True"			Type="Boolean"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="LockRight"			Visible=true			Group="Behavior"			InitialValue="False"			Type="Boolean"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="LockTop"			Visible=true			Group="Behavior"			InitialValue="True"			Type="Boolean"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="LockVertical"			Visible=true			Group="Behavior"			InitialValue="False"			Type="Boolean"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="MinimumRowHeight"			Visible=true			Group="Behavior"			InitialValue="22"			Type="Integer"			InheritedFrom="WebListBox"		#tag EndViewProperty		#tag ViewProperty			Name="Multiline"			Visible=true			Group="Behavior"			InitialValue="false"			Type="Boolean"			InheritedFrom="WebListBox"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="PrimaryRowColor"			Visible=true			Group="Behavior"			InitialValue="&cFFFFFF"			Type="Color"			InheritedFrom="WebListBox"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="TabOrder"			Visible=true			Group="Behavior"			InitialValue="0"			Type="Integer"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="VerticalCenter"			Group="Behavior"			Type="Integer"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="Visible"			Visible=true			Group="Behavior"			InitialValue="True"			Type="Boolean"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="Width"			Visible=true			Group="Behavior"			InitialValue="200"			Type="Integer"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="ZIndex"			Group="Behavior"			InitialValue="1"			Type="Integer"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="_HorizontalPercent"			Group="Behavior"			Type="Double"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="_IsEmbedded"			Group="Behavior"			Type="Boolean"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="_Locked"			Group="Behavior"			Type="Boolean"			InheritedFrom="WebObject"		#tag EndViewProperty		#tag ViewProperty			Name="_NeedsRendering"			Group="Behavior"			InitialValue="True"			Type="Boolean"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="_OfficialControl"			Group="Behavior"			InitialValue="False"			Type="Boolean"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="_OpenEventFired"			Group="Behavior"			Type="Boolean"			InheritedFrom="WebControl"		#tag EndViewProperty		#tag ViewProperty			Name="_VerticalPercent"			Group="Behavior"			Type="Double"			InheritedFrom="WebControl"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass