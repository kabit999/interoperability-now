#tag WebPageBegin WebPage pageXLIFFdocValidator   Cursor          =   0   Enabled         =   True   Height          =   602   HelpTag         =   ""   HorizontalCenter=   ""   ImplicitInstance=   True   Index           =   ""   IsImplicitInstance=   ""   Left            =   68   LockBottom      =   False   LockHorizontal  =   ""   LockLeft        =   False   LockRight       =   False   LockTop         =   False   LockVertical    =   ""   MinHeight       =   400   MinWidth        =   600   Style           =   "backgroundWhite"   TabOrder        =   ""   Title           =   "XLIFF:doc 1.0 Validator"   Top             =   143   VerticalCenter  =   ""   Visible         =   True   Width           =   600   ZIndex          =   1   _HorizontalPercent=   ""   _ImplicitInstance=   False   _IsEmbedded     =   ""   _Locked         =   ""   _NeedsRendering =   True   _OfficialControl=   False   _OpenEventFired =   ""   _ShownEventFired=   ""   _VerticalPercent=   ""   Begin WebFileUploader upl_xliffdocUploader      AlternateRowColor=   "&cEDF3FE"      Cursor          =   0      Enabled         =   True      FileCount       =   ""      Height          =   51      HelpTag         =   ""      HorizontalCenter=   ""      Index           =   -2147483648      Left            =   20      Limit           =   1      LockBottom      =   False      LockedInPosition=   False      LockHorizontal  =   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      LockVertical    =   False      PrimaryRowColor =   "&cFFFFFF"      Scope           =   0      Style           =   "None"      TabOrder        =   -1      Top             =   209      VerticalCenter  =   ""      Visible         =   True      Width           =   560      ZIndex          =   1      _HorizontalPercent=   ""      _IsEmbedded     =   ""      _Locked         =   ""      _NeedsRendering =   True      _OpenEventFired =   ""      _VerticalPercent=   ""   End   Begin WebLabel lbl_header      Cursor          =   1      Enabled         =   True      HasFocusRing    =   True      Height          =   51      HelpTag         =   ""      HorizontalCenter=   ""      Index           =   -2147483648      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockHorizontal  =   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      LockVertical    =   False      Multiline       =   False      Scope           =   0      Style           =   "h1"      TabOrder        =   0      Text            =   "XLIFF:doc 1.0 Validator"      Top             =   14      VerticalCenter  =   ""      Visible         =   True      Width           =   554      ZIndex          =   1      _HorizontalPercent=   ""      _IsEmbedded     =   ""      _Locked         =   ""      _NeedsRendering =   True      _OpenEventFired =   ""      _VerticalPercent=   ""   End   Begin WebLabel lbl_paraIntro      Cursor          =   1      Enabled         =   True      HasFocusRing    =   True      Height          =   76      HelpTag         =   ""      HorizontalCenter=   ""      Index           =   -2147483648      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockHorizontal  =   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      LockVertical    =   False      Multiline       =   True      Scope           =   0      Style           =   "regular"      TabOrder        =   1      Text            =   "This tool will validate uploaded XLIFF files against the specifications set out in the XLIFF:doc 1.0 reference guide. \r\rNote: This tool does not perform an XML schema validation pass. "      Top             =   87      VerticalCenter  =   ""      Visible         =   True      Width           =   554      ZIndex          =   1      _HorizontalPercent=   ""      _IsEmbedded     =   ""      _Locked         =   ""      _NeedsRendering =   True      _OpenEventFired =   ""      _VerticalPercent=   ""   End   Begin WebLabel lbl_headerUpload      Cursor          =   1      Enabled         =   True      HasFocusRing    =   True      Height          =   30      HelpTag         =   ""      HorizontalCenter=   ""      Index           =   -2147483648      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockHorizontal  =   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      LockVertical    =   False      Multiline       =   True      Scope           =   0      Style           =   "h2"      TabOrder        =   2      Text            =   "Choose an XLIFF:doc to Validate"      Top             =   175      VerticalCenter  =   ""      Visible         =   True      Width           =   554      ZIndex          =   1      _HorizontalPercent=   ""      _IsEmbedded     =   ""      _Locked         =   ""      _NeedsRendering =   True      _OpenEventFired =   ""      _VerticalPercent=   ""   End   Begin WebButton btn_submit      Caption         =   "Submit"      Cursor          =   0      Enabled         =   False      Height          =   22      HelpTag         =   ""      HorizontalCenter=   ""      Index           =   -2147483648      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockHorizontal  =   False      LockLeft        =   True      LockRight       =   False      LockTop         =   True      LockVertical    =   False      Scope           =   0      Style           =   "None"      TabOrder        =   3      Top             =   270      VerticalCenter  =   ""      Visible         =   True      Width           =   100      ZIndex          =   1      _HorizontalPercent=   ""      _IsEmbedded     =   ""      _Locked         =   ""      _NeedsRendering =   True      _OpenEventFired =   ""      _VerticalPercent=   ""   End   Begin WebLabel lbl_paraFooter      Cursor          =   1      Enabled         =   True      HasFocusRing    =   True      Height          =   20      HelpTag         =   ""      HorizontalCenter=   ""      Index           =   -2147483648      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockHorizontal  =   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      LockVertical    =   False      Multiline       =   True      Scope           =   0      Style           =   "small"      TabOrder        =   4      Text            =   "The XLIFF:doc 1.0 Validator was built as part of Interoperability Now! using Xojo. "      Top             =   546      VerticalCenter  =   ""      Visible         =   True      Width           =   554      ZIndex          =   1      _HorizontalPercent=   ""      _IsEmbedded     =   ""      _Locked         =   ""      _NeedsRendering =   True      _OpenEventFired =   ""      _VerticalPercent=   ""   End   Begin WebLink lnk_footer      Cursor          =   0      Enabled         =   True      HasFocusRing    =   True      Height          =   22      HelpTag         =   ""      HorizontalCenter=   ""      Index           =   -2147483648      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockHorizontal  =   False      LockLeft        =   True      LockRight       =   False      LockTop         =   False      LockVertical    =   False      Multiline       =   False      Scope           =   0      Style           =   "small"      TabOrder        =   5      Target          =   1      Text            =   "Questions? Email me."      Top             =   564      URL             =   "mailto:micahbly@gmail.com"      VerticalCenter  =   ""      Visible         =   True      Width           =   168      ZIndex          =   1      _HorizontalPercent=   ""      _IsEmbedded     =   ""      _Locked         =   ""      _NeedsRendering =   True      _OpenEventFired =   ""      _VerticalPercent=   ""   End   Begin WebLabel lbl_headerResults      Cursor          =   1      Enabled         =   True      HasFocusRing    =   True      Height          =   30      HelpTag         =   ""      HorizontalCenter=   ""      Index           =   -2147483648      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockHorizontal  =   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      LockVertical    =   False      Multiline       =   True      Scope           =   0      Style           =   "h2"      TabOrder        =   6      Text            =   "Validation Results"      Top             =   326      VerticalCenter  =   ""      Visible         =   True      Width           =   554      ZIndex          =   1      _HorizontalPercent=   ""      _IsEmbedded     =   ""      _Locked         =   ""      _NeedsRendering =   True      _OpenEventFired =   ""      _VerticalPercent=   ""   End   Begin autoLoadingWebListBox lst_Results      AlternateRowColor=   "&cEDF3FE"      ColumnCount     =   1      ColumnWidths    =   "*"      Cursor          =   0      Enabled         =   True      HasHeading      =   True      Height          =   136      HelpTag         =   ""      HorizontalCenter=   ""      Index           =   -2147483648      InitialValue    =   ""      Left            =   20      ListIndex       =   -1      LockBottom      =   True      LockedInPosition=   False      LockHorizontal  =   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      LockVertical    =   False      MinimumRowHeight=   22      Multiline       =   false      PrimaryRowColor =   "&cFFFFFF"      Scope           =   0      Style           =   "small"      TabOrder        =   -1      Top             =   359      VerticalCenter  =   ""      Visible         =   True      Width           =   560      ZIndex          =   1      _HorizontalPercent=   ""      _IsEmbedded     =   ""      _Locked         =   ""      _NeedsRendering =   True      _OpenEventFired =   ""      _VerticalPercent=   ""   End   Begin WebButton btn_downloadResults      Caption         =   "Download Results as CSV"      Cursor          =   0      Enabled         =   True      Height          =   22      HelpTag         =   ""      HorizontalCenter=   ""      Index           =   -2147483648      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockHorizontal  =   False      LockLeft        =   True      LockRight       =   False      LockTop         =   False      LockVertical    =   False      Scope           =   0      Style           =   "None"      TabOrder        =   7      Top             =   507      VerticalCenter  =   ""      Visible         =   True      Width           =   211      ZIndex          =   1      _HorizontalPercent=   ""      _IsEmbedded     =   ""      _Locked         =   ""      _NeedsRendering =   True      _OpenEventFired =   ""      _VerticalPercent=   ""   EndEnd#tag EndWebPage#tag WindowCode	#tag Method, Flags = &h21		Private Sub FileDownloaded(file As WebFile)		  If file = self.csvFile Then		    self.csvFile = Nil		    'MsgBox("Download completed.")		  End If		End Sub	#tag EndMethod	#tag Property, Flags = &h21		Private csvFile As WebFile	#tag EndProperty#tag EndWindowCode#tag Events upl_xliffdocUploader	#tag Event		Sub FileAdded(Filename As String)		  // Remove any files that do not end in .jpg		  		  If Right(Filename, 4) <> ".xlf" and right(filename,6) <> ".xliff" Then		    MsgBox("Please choose only XLIFF files (this check is for .xlf and .xliff file extensions).")		    Me.RemoveFileAtIndex(Me.FileCount - 1)		    return		  End If		  		  		  // enable submit button		  btn_submit.Enabled = true		  		End Sub	#tag EndEvent	#tag Event		Sub UploadComplete(Files() As WebUploadedFile)		  // When the files have been uploaded, this events fires		  // with the Files() parameter populated with the		  // user's files.		  		  // we won't try to save a folderitem to disk, because A) we don't need to, and B) we want to be able to say we don't store any copies of the files uploaded.		  		  // there should be only one, but what the heck, we don't care...		  For Each file As WebUploadedFile In files		    Try		      dim myxmldoc as new XmlDocument		      dim filecontents as string		      filecontents = file.data.StringValue(0,file.data.size)		      myxmldoc.LoadXml(filecontents)		      		      // create new validation object and do validation		      dim myValidator as new XLIFFdocValidator(myxmldoc)		      if not myValidator.validate then		        // TM Tool thinks this is an invalid XLIFFdoc.		        dim XLIFFdocValidityErrorSummary as string		        XLIFFdocValidityErrorSummary = "Category" + TAB + "Where" + TAB + "Description" + endofline + myValidator.getErrorSummary()		        lst_Results.ReloadWithTabContents(XLIFFdocValidityErrorSummary,true)		        lst_Results.ColumnWidths = "10%,15%,75%"		        'lst_Results.Heading(0) = "Category"		        'lst_Results.Heading(1) = "Where"		        'lst_Results.Heading(2) = "Description"		      else		        dim s as string		        s = "Success!" + EndOfLine + "This XLIFF:doc file appears to be valid for XLIFF:doc 1.0. "		        lst_Results.ReloadWithTabContents(s,true)		        lst_Results.ColumnWidths = "*,0,0"		        'lst_Results.Heading(0) = "Success!"		      end if		      		    Catch err As XmlException		      // couldn't turn the uploaded file into an xml file.		      MsgBox("This file could not be examined: an XML error occurred. Please use check the file against the XLIFF:doc schema before before before uploading to this validator.")		    End Try		    		  Next		  		  		  		End Sub	#tag EndEvent#tag EndEvents#tag Events btn_submit	#tag Event		Sub Action()		  lbl_headerResults.text = localize.getwp("Validation Results ($1$)",upl_xliffdocUploader.FileAtIndex(0))		  upl_xliffdocUploader.Upload()		  		  // disable submit button		  me.Enabled = false		  		End Sub	#tag EndEvent#tag EndEvents#tag Events btn_downloadResults	#tag Event		Sub Action()		  		  // Create a text file to download		  if self.csvFile = nil then		    self.csvFile = New WebFile		    self.csvFile.MimeType = "text/csv"		    self.csvFile.ForceDownload = True		    self.csvFile.FileName = "XLIFFdoc_Validator_Results.csv"		    		    self.csvFile.Data = lst_Results.getContentsAsCSV()		    		    // This method is called when the download completes		    self.csvFile.OnDownloaded = WeakAddressOf FileDownloaded		  end if		  		  // Showing the URL prompts the browser to download it		  ShowURL(self.csvFile.URL)		End Sub	#tag EndEvent#tag EndEvents